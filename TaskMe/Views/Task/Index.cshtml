@model TaskMe.Models.TaskViewModel

@{
    ViewBag.Title = "Task List";
}

<link rel="stylesheet" href="~/css/home_index.css" />

<h2>Task List</h2>

<!-- Filter Form -->
<form method="get" class="filter-form">
    <div class="form-group">
        <label for="startDate">Start Date:</label>
        <input type="date" id="startDate" name="startDate" />
    </div>
    <div class="form-group">
        <label for="endDate">End Date:</label>
        <input type="date" id="endDate" name="endDate" />
    </div>
    <div class="form-group">
        <label for="priority">Priority:</label>
        <select id="priority" name="priority">
            <option value="">All</option>
            <option value="1">Low</option>
            <option value="2">Medium</option>
            <option value="3">High</option>
            <option value="4">Urgent</option>
        </select>
    </div>
    <button type="submit" class="btn btn-filter">Filter</button>
</form>

<!-- Button to Add New Task -->
<h3><a href="@Url.Action("AddTask", "Task")" class="btn btn-add">Add New Task</a></h3>

<!-- Remaining Tasks -->
<h3>Remaining Tasks</h3>
@if (Model.RemainingTasks.Count() > 0)
{
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Due Date</th>
                <th>Created At</th>
                <th>Priority</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var task in Model.RemainingTasks)
            {
                <tr>
                    <td>@task.Title</td>
                    <td>@task.Description</td>
                    <td>@task.DueDate.ToString("yyyy-MM-dd")</td>
                    <td>@task.CreatedAt.ToString("yyyy-MM-dd")</td>
                    <td>@task.Priority.ToString()</td>
                    <td>
                        <form method="post" action="@Url.Action("MarkAsCompleted", "Task")" style="display:inline;">
                            <input type="hidden" name="id" value="@task.Id" />
                            <button type="submit" class="btn btn-complete">Mark as Completed</button>
                        </form>
                        <a href="@Url.Action("UpdateTask", "Task", new { id = task.Id })" class="btn btn-update">Update</a>
                        <form method="post" asp-action="DeleteTask" style="display:inline;">
                            <input type="hidden" name="id" value="@task.Id" />
                            <button type="submit" class="btn btn-delete">Delete</button>
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>No remaining tasks.</p>
}

<!-- Completed Tasks -->
<h3>Completed Tasks</h3>
@if (Model.CompletedTasks.Count() > 0)
{
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Due Date</th>
                <th>Created At</th>
                <th>Priority</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var task in Model.CompletedTasks)
            {
                <tr>
                    <td>@task.Title</td>
                    <td>@task.Description</td>
                    <td>@task.DueDate.ToString("yyyy-MM-dd")</td>
                    <td>@task.CreatedAt.ToString("yyyy-MM-dd")</td>
                    <td>@task.Priority.ToString()</td>
                    <td>
                        <a href="@Url.Action("UpdateTask", "Task", new { id = task.Id })" class="btn btn-update">Update</a>
                        <form method="post" asp-action="DeleteTask" style="display:inline;">
                            <input type="hidden" name="id" value="@task.Id" />
                            <button type="submit" class="btn btn-delete">Delete</button>
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>No completed tasks.</p>
}
